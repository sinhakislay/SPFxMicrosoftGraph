import * as tslib_1 from "tslib";
import { BaseComponentContext } from '@microsoft/sp-component-base';
import { SPEvent } from '@microsoft/sp-core-library';
import BaseApplication from './BaseApplication';
import { Flights } from './common/Flights';
/**
 * Context object for a client-side applications.
 *
 * @alpha
 */
var BaseApplicationContext = /** @class */ (function (_super) {
    tslib_1.__extends(BaseApplicationContext, _super);
    /** @internal */
    function BaseApplicationContext(parameters) {
        var _this = _super.call(this, parameters) || this;
        _this._disposed = false;
        _this._delayExtensionsLoading = false;
        _this._preloadedData = parameters.navigator.preloadedData;
        _this._navigator = parameters.navigator;
        _this._chrome = parameters.chrome;
        _this._loadType = parameters.loadType;
        _this._prefetchedDataEvent = new SPEvent(BaseApplication._prefetchedDataEventName);
        return _this;
    }
    /**
     * Diposes the application context
     */
    BaseApplicationContext.prototype.dispose = function () {
        if (this._disposed) {
            return;
        }
        if (this._navigator) {
            this._navigator = undefined;
        }
        if (this._chrome && !Flights.useNextGenSPA) {
            this._chrome.dispose();
        }
        _super.prototype.dispose.call(this);
        this._disposed = true;
    };
    /**
     * Sets the SuiteNav manager in the application context.
     */
    BaseApplicationContext.prototype.initializeSuiteNavManager = function (suiteNavManager) {
        this._suiteNavManager = suiteNavManager;
    };
    Object.defineProperty(BaseApplicationContext.prototype, "preloadedData", {
        /**
         * The preloaded data used by SPFx
         */
        get: function () { return this._preloadedData; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseApplicationContext.prototype, "navigator", {
        /**
         * The application navigator
         */
        get: function () { return this._navigator; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseApplicationContext.prototype, "chrome", {
        /**
         * The application page chrome
         */
        get: function () { return this._chrome; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseApplicationContext.prototype, "loadType", {
        /**
         * The application load type
         */
        get: function () { return this._loadType; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseApplicationContext.prototype, "prefetchedDataEvent", {
        /**
         * An event that gets fired when the application prefetched data is available.
         */
        get: function () { return this._prefetchedDataEvent; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseApplicationContext.prototype, "suiteNavManager", {
        /**
         * The SuiteNav manager
         *
         * @remarks
         * The SuiteNav manager is defined only after the application starts rendering.
         * Chromeless application do not have a SuiteNav manager.
         */
        get: function () {
            return this._suiteNavManager;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseApplicationContext.prototype, "delayExtensionsLoading", {
        /**
         * Gets a value indicating whether or not extensions loading should be delayed.
         */
        get: function () { return this._delayExtensionsLoading; },
        /**
         * Sets a value to indicate whether or not extensions loading should be delayed.
         */
        set: function (delay) { this._delayExtensionsLoading = delay; },
        enumerable: true,
        configurable: true
    });
    return BaseApplicationContext;
}(BaseComponentContext));
export default BaseApplicationContext;
//# sourceMappingURL=BaseApplicationContext.js.map