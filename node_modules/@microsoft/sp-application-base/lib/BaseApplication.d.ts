import { BaseComponent } from '@microsoft/sp-component-base';
import { IBrowserCompatibility } from '@microsoft/sp-core-library';
import { _IPreloadedData } from '@microsoft/sp-loader';
import { ISuiteNavManagerConfiguration, ISuiteNavConfigurationData } from '@ms/sp-suite-nav';
import BaseApplicationContext, { IApplicationContextParameters } from './BaseApplicationContext';
import { INavigationProperties, INavigationResult } from './navigator/INavigationResult';
import SPThemeProvider from './pageChrome/SPThemeProvider';
/**
 * This is the system base class for client-side applications.  It manages the overall
 * life cycle of your application, and is the first entry point for your code to start
 * executing when the page loads.  The two main events are onLoad() which occurs first,
 * and onRender() which occurs after the application manager has initialized the environment
 * and completed rendering the page chrome.
 *
 * @alpha
 */
export default class BaseApplication extends BaseComponent {
    /**
     * SPEvent name for page navigation.
     * @internal
     */
    static _navigatedEventName: string;
    /**
     * SPEvent name for layout changes.
     * @internal
     */
    static _layoutChangedEventName: string;
    /**
     * SPEvent name for prefetched data availability.
     * @internal
     */
    static _prefetchedDataEventName: string;
    /**
     * SPEvent name for application pre in-place navigation.
     * @internal
     */
    static _onBeforeNavigationEventName: string;
    /**
     * Overrides the IClientSideComponentManifest.alias value provided in the manifest.
     */
    readonly alias: string;
    /**
     * {@inheritDoc @microsoft/sp-component-base#BaseComponent.context}
     */
    protected readonly context: BaseApplicationContext;
    constructor();
    /**
     * Returns the DOM element where the application is expected to render its content.
     * The domElement will be undefined until the onRender() event occurs.
     *
     * @remarks
     * IMPORTANT: The application should not access DOM elements outside of this subtree,
     * as they are system-defined and may change over time.
     *
     * Throws an error if the domElement is undefined.
     */
    protected domElement: HTMLDivElement;
    /**
     * RESERVED FOR INTERNAL USAGE. This method is invoked automatically by the application manager.
     * The application code should not call it directly.
     *
     * @internal
     */
    _load(contextParameters: IApplicationContextParameters): Promise<void>;
    /**
     * RESERVED FOR INTERNAL USAGE. This method is invoked automatically by the application manager
     * to render the application.
     * The application code should not call it directly.
     *
     * @internal
     */
    _render(): void;
    /**
     * RESERVED FOR INTERNAL USAGE. This method is invoked by the application manager
     * to unload the application. The page chrome is still available at this point
     * The application code should not call it directly.
     *
     * @internal
     */
    _unload(): void;
    /**
     * RESERVED FOR INTERNAL USAGE. This method is invoked automatically by the application manager
     * to load the application specific theme.
     * The application code should not call it directly.
     *
     * @internal
     */
    _loadTheme(): void;
    /**
     * RESERVED FOR INTERNAL USAGE.
     * Internal API to dispose the application.
     * See onDispose for more details
     */
    dispose(): void;
    /**
     * Returns browser compatibility information for the application.
     *
     * @remarks
     * The SharePoint Framework tracks browser compatibility for the application and the framework.
     * Taken together, this information will determine the experience for the end user.
     *
     * Implement this method to report the level of support that your application provides for the current web browser.
     * Since the User Agent field is impersonated by various browsers, itâ€™s recommended for the implementation to test
     * individual API features rather than trying to identify specific releases of browsers.
     */
    getBrowserCompatibility(): IBrowserCompatibility;
    /**
     * This virtual function returns the default configuration and can be configured by applications
     * when required.
     */
    suiteNavConfiguration(): ISuiteNavManagerConfiguration;
    delayExtensionsLoading(): boolean;
    /**
     * This virtual function returns the default application context and can be configured by applications
     * when required.
     *
     * @internal
     */
    protected _getApplicationContext(contextParameters: IApplicationContextParameters): BaseApplicationContext;
    /**
     * This virtual function returns the default application theme provider and can be overridden by applications
     * when required.
     *
     * @internal
     */
    protected _getThemeProvider(): SPThemeProvider;
    /**
     * This life cycle event occurs immediately after the application manager has loaded the application,
     * before the DOM is constructed.  Applications can use this event to load scripts
     * or start asynchronous operations that need to occur early in the lifecycle.
     * Inside the onLoad() event, applications may also modify the rendering of various
     * page chrome elements, for example by calling this.context.suiteNav.setComponentVisibility(false).
     */
    protected onLoad(): Promise<void>;
    /**
     * This lifecycle event occurs before hiding the application chrome. At this point the application still has
     * the DOM element available and can perform specific operations before the chrome is hidden from the view-port
     */
    protected onUnload(): void;
    /**
     * This lifecycle event occurs after the application manager has constructed the DOM for the page chrome.
     * At this time, the domElement property will be initialized, and the application can begin
     * rendering its own DOM elements.
     */
    protected onRender(): void;
    /**
     * This API is called at the end of the application lifecycle. It should be used to dispose any local
     * resources (i.e. DOM elements) that the application is holding onto.
     *
     * This API is expected to be called in scenarios like cross-application navigation
     * i.e. the host is transitioning from one application to another and disposes the application that is being
     * transitioned out.
     */
    protected onDispose(): void;
    /**
     * Provides the data necessary to construct an instance of SuiteNavManagerConfiguration
     * @internal
     */
    protected _getSuiteNavManagerConfigurationData(): ISuiteNavConfigurationData;
    /**
     * Causes the navigator to navigate to a new page
     *
     * @remarks
     * This will be removed soon. Please use navigator from application context
     * to invoke public APIs
     */
    protected _navigate(url: string, props?: INavigationProperties): Promise<INavigationResult>;
    /**
     * Allows the navigator to reinitialize SPFx components with `_IPreloadedData`.
     *
     * @remarks
     * This will be removed soon. Please use navigator from application context
     * to invoke public APIs
     *
     * Navigation is an async operation but calling this API ignores the promise.
     * This is used by List application to change the context, so the framework will send the appropriate events
     * for the context change, but it doesn't impact the application.
     */
    protected _navigateToPreloadedData(preloadedData: _IPreloadedData): void;
    /**
     * Invalidates a cached resource by its URL. Any subsequent request for the resource
     * will be fetched from its origin and recached.
     *
     * @param url - URL to invalidate
     *
     * @remarks
     * This will be removed soon. Please use navigator from application context
     * to invoke public APIs
     */
    protected _invalidate(url: string): Promise<void>;
    /**
     * Raises an event for a layout change.
     */
    protected raiseLayoutChangedEvent(): void;
    private _handleThemeChange;
    private _shouldDisableSuiteNav;
    /**
     * This is a handler to update Suite Nav container height, when sp-suite-nav wants to update it.
     *
     * @param height - Height of the suite nav bar container to be set.
     */
    private _suiteNavHeightHandler;
}
//# sourceMappingURL=BaseApplication.d.ts.map