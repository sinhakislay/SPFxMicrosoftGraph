/// <reference types="node" />
import * as Gulp from 'gulp';
import { IClientSideComponentManifest } from '@microsoft/sp-module-interfaces';
import OdspGulpTask from './../OdspGulpTask';
import { ICumulativeManifestOptions } from './../cumulativeManifestProcessor';
export interface IWriteManifestsTaskConfig {
    /**
     * The deploy CDN path. If both deployCdnPath and manifestDeployCdnPath are provided, the deployCdnPath
     * is used for manifest icons and the manifestDeployCdnPath is used for manifest JSON files
     */
    deployCdnPath?: string;
    /**
     * The manifest deploy path. If not provided, defaults to deployCdnPath
     */
    manifestDeployCdnPath?: string;
    /**
     * The CDN base path. This value will populate the "internalModuleBaseUrls" CDN manifest property.
     */
    cdnBasePath?: string;
    /**
     * The debug base path, which is the value that will populate the "internalModuleBaseUrls" manifest property for
     *  debug manifests.
     */
    debugBasePath?: string;
    /**
     * If specified, only use this locale.
     */
    buildSingleLocale?: string;
    /**
     * Options for the cumulative manifest files to be dropped in the dist folder. If this field is null, cumulative
     *  files will not be produced.
     */
    cumulativeManifestOptions?: ICumulativeManifestOptions;
    /**
     * A function that takes a manifest and returns an object. If defined, it is called on every production manifest
     *  before being written to disk.
     */
    postProcessProductionManifestFunction?: (manifest: IClientSideComponentManifest) => Object;
    /**
     * A function that takes a manifest and returns an object. If defined, it is called on every debug manifest
     *  before being written to disk.
     */
    postProcessDebugManifestsFunction?: (manifest: IClientSideComponentManifest) => Object;
}
/**
 * The type of icon URL defined in a user-created manifest.
 */
export declare enum IconPathType {
    /**
     * Something that doesn't fit into another category. A warning will be printed.
     */
    Malformed = 0,
    /**
     * An absolute URL. Something that begins with a protocol (i.e. - http://...).
     */
    AbsoluteUrl = 1,
    /**
     * A relative URL. Something that begins with an alphanumeric character, but doesn't look like a protocol.
     */
    RelativeUrl = 2,
    /**
     * A relative filesystem path. Something that begins with "./" or "../"
     */
    RelativePath = 3,
    /**
     * A data:image;... url
     */
    DataUrl = 4
}
export declare function getIconPathType(iconPath: string | undefined): IconPathType | undefined;
/**
 * Writes a manifest for each entry in the project.
 *
 * Example:
 *  IN:
 *   the result of the prepareDeploy step enumerating each entry, each entry's dependencies, and a developer-generated
 *    base manifest for each entry.
 *
 *  OUT:
 *   a debug and, optionally, a production manifest for each entry.
 */
export declare class WriteManifestsTask extends OdspGulpTask<IWriteManifestsTaskConfig> {
    private _localizedResourcesCache;
    private _defaultLanguagesMapping;
    constructor();
    loadSchema(): Object;
    executeTask(gulp: typeof Gulp, completeCallback: (error?: string) => void): NodeJS.ReadWriteStream;
    /**
     * Does some component-type-specific manifest processing.
     */
    private _doComponentTypeSpecificFixup;
    /**
     * Perform some final fixup on manifests.
     */
    private _doFinalManifestFixup;
    /**
     * Does webpart-specific manifest processing.
     */
    private _processWebpartManifest;
    /**
     * Localizes an Application manifest. This includes title and description of the Application
     */
    private _localizeApplicationManifest;
    /**
     * Does extension-specific manifest processing.
     */
    private _processExtensionsManifest;
    /**
     * Localizes a string with an id in the web $moduleName:expression;
     * If the string to localize is not based on an id, it returns the input param untouched.
     */
    private _localizeString;
    /**
     * Localizes a string where it's been verified that the id follows the schema.
     * @param resourceName - Name of the resource to load
     * @param expression - Expression to be evaluated on the resource
     * @stringId Original id for the string. Used for logging purposes only
     * @returns Localized string with all found locales
     */
    private _localizeStringInternal;
    /**
     * Computes where an icon is on disk, copies it to the appropriate deployment directory
     *  depending on build flavor, and returns the correct path for the manifest.
     */
    private _processIconPath;
    /**
     * Gets a resource file from a path.
     */
    private _getResource;
    /**
     * Caches a resource file from a path.
     * Because this execute in the build tools, function define is not defined,
     * so a fake function is created that will return the default element of the module.
     */
    private _cacheResource;
    private _generateManifest;
    private _getDefaultLangaugesMapping;
    private _generateLoaderConfig;
    private _resolveDebugPath;
    private _resolveProductionPath;
}
//# sourceMappingURL=WriteManifestsTask.d.ts.map