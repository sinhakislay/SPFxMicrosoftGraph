import { ServiceKey } from '@microsoft/sp-core-library';
import MSGraphClient from './MSGraphClient';
/**
 * Returns a preinitialized version of the MSGraphClient.
 * For more information: {@link https://docs.microsoft.com/en-us/sharepoint/dev/spfx/use-msgraph}
 *
 * @public
 */
var MSGraphClientFactory = /** @class */ (function () {
    /**
     * @param serviceScope - Provides services for the MSGraphClient to consume.
     *
     * @internal
     */
    function MSGraphClientFactory(serviceScope) {
        this._serviceScope = serviceScope;
    }
    /**
     * Returns an instance of the MSGraphClient that communicates with the current tenant's configurable
     * Service Principal.
     */
    MSGraphClientFactory.prototype.getClient = function () {
        var _this = this;
        /* tslint:disable:next-line no-any */
        if (!MSGraphClient._instance) {
            /* tslint:disable:next-line max-line-length */
            return import(/* webpackChunkName: 'sp-http-msgraphclient' */ '@microsoft/microsoft-graph-client/lib/graph-js-sdk-web')
                .then(function () {
                return new MSGraphClient(_this._serviceScope);
            });
        }
        else {
            return Promise.resolve(new MSGraphClient(this._serviceScope));
        }
    };
    /**
     * The service key for MSGraphClientFactory.
     */
    MSGraphClientFactory.serviceKey = ServiceKey.create('sp-http:MSGraphClientFactory', MSGraphClientFactory);
    return MSGraphClientFactory;
}());
export default MSGraphClientFactory;
//# sourceMappingURL=MSGraphClientFactory.js.map