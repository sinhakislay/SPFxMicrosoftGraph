{"version":3,"file":"CommandLineMigrationAdvisor.js","sourceRoot":"","sources":["../../src/cli/CommandLineMigrationAdvisor.ts"],"names":[],"mappings":";AAAA,4FAA4F;AAC5F,2DAA2D;;AAE3D,iCAAiC;AAEjC,0DAAuD;AACvD,sDAAmD;AAEnD,MAAa,2BAA2B;IAEtC,wDAAwD;IACxD,mFAAmF;IAC5E,MAAM,CAAC,SAAS,CAAC,IAAc;QACpC,4BAA4B;QAC5B,MAAM,IAAI,GAAa,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAE7C,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;YAEnB,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;gBAC1B,2BAA2B,CAAC,iBAAiB,CAC3C,wEAAwE,CAAC,CAAC;gBAC5E,OAAO,KAAK,CAAC;aACd;YAED,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;gBACzB,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;oBACrC,2BAA2B,CAAC,iBAAiB,CAC3C,oEAAoE,CAAC,CAAC;oBACxE,OAAO,KAAK,CAAC;iBACd;gBACD,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;oBAC3B,2BAA2B,CAAC,iBAAiB,CAC3C,0DAA0D,CAAC,CAAC;oBAC9D,OAAO,KAAK,CAAC;iBACd;gBACD,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE;oBAChC,2BAA2B,CAAC,iBAAiB,CAC3C,gEAAgE,CAAC,CAAC;oBACpE,OAAO,KAAK,CAAC;iBACd;gBACD,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;oBAC3B,2BAA2B,CAAC,iBAAiB,CAC3C,2DAA2D,CAAC,CAAC;oBAC/D,OAAO,KAAK,CAAC;iBACd;aACF;SACF;QAED,qBAAqB;QACrB,OAAO,IAAI,CAAC;IACd,CAAC;IAEO,MAAM,CAAC,iBAAiB,CAAC,OAAe;QAC9C,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,qBAAS,CAAC,SAAS,CAC3C,oGAAoG,CACpG,CAAC,CAAC,CAAC;QACJ,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,qBAAS,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAC3D,OAAO,CAAC,KAAK,EAAE,CAAC;QAChB,OAAO,CAAC,KAAK,CAAC,qBAAS,CAAC,SAAS,CAAC,qEAAqE;cACnG,iBAAiB,6BAAa,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;IACxD,CAAC;CAEF;AAtDD,kEAsDC","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\n\r\nimport * as colors from 'colors';\r\n\r\nimport { RushConstants } from '../logic/RushConstants';\r\nimport { Utilities } from '../utilities/Utilities';\r\n\r\nexport class CommandLineMigrationAdvisor {\r\n\r\n  // NOTE: THIS RUNS BEFORE THE REAL COMMAND-LINE PARSING.\r\n  // TAKE EXTREME CARE THAT THE HEURISTICS CANNOT FALSELY MATCH A VALID COMMAND LINE.\r\n  public static checkArgv(argv: string[]): boolean {\r\n    // 0=node.exe, 1=script name\r\n    const args: string[] = process.argv.slice(2);\r\n\r\n    if (args.length > 0) {\r\n\r\n      if (args[0] === 'generate') {\r\n        CommandLineMigrationAdvisor._reportDeprecated(\r\n          'Instead of \"rush generate\", use \"rush update\" or \"rush update --full\".');\r\n        return false;\r\n      }\r\n\r\n      if (args[0] === 'install') {\r\n        if (args.indexOf('--full-clean') >= 0) {\r\n          CommandLineMigrationAdvisor._reportDeprecated(\r\n            'Instead of \"rush install --full-clean\", use \"rush purge --unsafe\".');\r\n          return false;\r\n        }\r\n        if (args.indexOf('-C') >= 0) {\r\n          CommandLineMigrationAdvisor._reportDeprecated(\r\n            'Instead of \"rush install -C\", use \"rush purge --unsafe\".');\r\n          return false;\r\n        }\r\n        if (args.indexOf('--clean') >= 0) {\r\n          CommandLineMigrationAdvisor._reportDeprecated(\r\n            'Instead of \"rush install --clean\", use \"rush install --purge\".');\r\n          return false;\r\n        }\r\n        if (args.indexOf('-c') >= 0) {\r\n          CommandLineMigrationAdvisor._reportDeprecated(\r\n            'Instead of \"rush install -c\", use \"rush install --purge\".');\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Everything is okay\r\n    return true;\r\n  }\r\n\r\n  private static _reportDeprecated(message: string): void {\r\n    console.error(colors.red(Utilities.wrapWords(\r\n     'ERROR: You specified an outdated command-line that is no longer supported by this version of Rush:'\r\n    )));\r\n    console.error(colors.yellow(Utilities.wrapWords(message)));\r\n    console.error();\r\n    console.error(Utilities.wrapWords(`For command-line help, type \"rush -h\".  For migration instructions,`\r\n      + ` please visit ${RushConstants.rushWebSiteUrl}`));\r\n  }\r\n\r\n}\r\n"]}