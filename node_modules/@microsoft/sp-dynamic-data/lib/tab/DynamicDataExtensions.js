/// <reference types='@ms/sp-tab-tasklib' />
var DynamicDataExtensions = /** @class */ (function () {
    function DynamicDataExtensions() {
    }
    DynamicDataExtensions.prototype.TestName = function () {
        return 'Dynamic Data Extensions test';
    };
    DynamicDataExtensions.prototype.TestOwner = function () {
        return 'patsppplat';
    };
    DynamicDataExtensions.prototype.TestOwnerTeam = function () {
        return 'DevPlat\\SPFX';
    };
    /**
     * These scripts are required for the tests to run.
     */
    DynamicDataExtensions.prototype.TestIncludeScripts = function () {
        return [
            '<ProductScriptsLocation>msajaxbundle.debug.js',
            '<ProductScriptsLocation>sp.runtime.debug.js',
            '<ProductScriptsLocation>sp.debug.js',
            '<TestLocation>/TabTaskLib.debug.js',
            '<AzureTaskLibLocation>/sp-tab-tasklib.js'
        ];
    };
    DynamicDataExtensions.prototype.TestSetup = function () {
        SPTaskLib.PageUtil.SetDebugManifests();
        TAB.Log.Comment('Dynamic Data Extensions Test start');
    };
    DynamicDataExtensions.prototype.TestRun = function () {
        var dataAutomationId = 'tabTestSuccess';
        var customActions = {
            '5779a78b-5014-4b7b-8a86-b8be228fc469': {
                'location': 'ClientSideExtension.ApplicationCustomizer',
                'properties': {
                    'dynamicDataKey': 'DynamicKey',
                    'dynamicDataValue': 'Value'
                }
            },
            '1e0fdd6b-2cad-4f71-85e0-c41db68705b5': {
                'location': 'ClientSideExtension.ApplicationCustomizer',
                'properties': {
                    'sourceComponentId': '5779a78b-5014-4b7b-8a86-b8be228fc469',
                    'sourcePropertyId': 'DynamicKey',
                    'dataAutomationId': dataAutomationId
                }
            }
        };
        var customActionParams = JSON.stringify(customActions);
        var spQueryParams = {
            customActions: customActionParams
        };
        var newsPagePath = '/_layouts/15/news.aspx';
        var pageUrl = SPTaskLib.PageUtil.CreatePageUrl(newsPagePath, spQueryParams);
        TAB.AddTask(TAB.LoadPage(pageUrl));
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists(dataAutomationId);
        TAB.Log.AddTaskPass('Test complete');
    };
    return DynamicDataExtensions;
}());
TabTest = DynamicDataExtensions;
//# sourceMappingURL=DynamicDataExtensions.js.map