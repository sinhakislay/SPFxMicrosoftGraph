import { _BrowserDetection } from '@microsoft/sp-core-library';
import strings from './Utilities.resx';
var BrowserSupport = /** @class */ (function () {
    function BrowserSupport() {
    }
    BrowserSupport.getBrowserCompatibility = function () {
        var browserInfo = _BrowserDetection.getBrowserInformation();
        // IE9 (and older versions) are unreliable and Pages doesn't work properly
        if (browserInfo.browser === 4 /* IE */ &&
            browserInfo.browserVersion && browserInfo.browserVersion.major <= 9) {
            return {
                supportLevel: 3 /* Blocked */,
                warning: strings.ie9OrOlderNotSupportedError
            };
        }
        if (browserInfo.browser === 3 /* Firefox */ &&
            browserInfo.browserVersion && browserInfo.browserVersion.major <= 43) {
            return {
                supportLevel: 3 /* Blocked */,
                warning: strings.firefox43OrOlderNotSupportedError
            };
        }
        // Old versions of Firefox (<44) have a bug where the Headers object is defined,
        // but it lacks Headers.forEach method. This bug is also impact instances of Firefox 44/45
        // fetch polyfill handles the case where Headers are just not present (IE/Safari)
        if (typeof Headers !== 'undefined' &&
            typeof Headers.prototype.forEach === 'undefined') {
            return {
                supportLevel: 3 /* Blocked */,
                warning: undefined
            };
        }
        return {
            supportLevel: 0 /* None */,
            warning: undefined
        };
    };
    return BrowserSupport;
}());
export default BrowserSupport;
//# sourceMappingURL=BrowserSupport.js.map