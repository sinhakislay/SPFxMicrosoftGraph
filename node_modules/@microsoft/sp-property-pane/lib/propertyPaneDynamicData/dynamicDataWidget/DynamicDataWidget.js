import * as tslib_1 from "tslib";
import { Label } from '@microsoft/office-ui-fabric-react-bundle';
import * as React from 'react';
import Styles from '../DynamicDataWidget.module.scss';
import DynamicDataWidgetSource from '../dynamicDataWidgetSource/DynamicDataWidgetSource';
import { DynamicDataSharedDepth } from '../IDynamicConfiguration';
var DynamicDataWidget = /** @class */ (function (_super) {
    tslib_1.__extends(DynamicDataWidget, _super);
    function DynamicDataWidget() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * Renders the dynamic data widget.
     */
    DynamicDataWidget.prototype.render = function () {
        var _this = this;
        this._widgetSources = [];
        if (this._isSourceShared()) {
            this._widgetSources.push(this._renderWidgetSource(this.props.entries));
        }
        else {
            this.props.entries.forEach(function (entry) {
                _this._widgetSources.push(_this._renderWidgetSource([entry]));
            });
        }
        return (React.createElement("div", null, this._widgetSources));
    };
    /**
     * Source is usually shared. However, in the case of DynamicFieldSet there
     * is a possibility that multiple fields are passed, with no shared configuration.
     *
     * It is assumed that if the property is shared, then automatically source will
     * become shared.
     */
    DynamicDataWidget.prototype._isSourceShared = function () {
        // TODO: This should be fixed after the Experience Review where DynamicField and DynamicFieldSet
        // share the same implementation
        if (this.props.entries.length === 1) {
            return true;
        }
        else {
            // If we are here, then the type must be DynamicFieldSet
            var sharedConfiguration = this.props.fieldProperties.sharedConfiguration;
            return !!(sharedConfiguration && sharedConfiguration.depth !== DynamicDataSharedDepth.None);
        }
    };
    DynamicDataWidget.prototype._renderWidgetSource = function (entries) {
        var currentKey = this.props.parentKey + '-dynamicDataWidgetSource' + this._widgetSources.length;
        return (React.createElement("div", { key: currentKey, className: Styles.dynamicDataWidget },
            (entries.length === 1) &&
                React.createElement(Label, { className: Styles.entryLabel }, entries[0].properties.label),
            React.createElement(DynamicDataWidgetSource, tslib_1.__assign({}, this.props, { parentKey: currentKey, entries: entries }))));
    };
    return DynamicDataWidget;
}(React.Component));
export default DynamicDataWidget;
//# sourceMappingURL=DynamicDataWidget.js.map